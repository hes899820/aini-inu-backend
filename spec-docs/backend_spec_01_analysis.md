# 🐕 아이니이누 (Aini Inu) - 백엔드 기술 명세서

**버전**: v1.0  
**작성일**: 2026-01-26  
**프로젝트명**: 반려견 산책 소셜 매칭 플랫폼

---

# 1. 기획안 분석

## 1.1 핵심 기능 요약

### 주요 기능 (Core Features)

| 기능 영역 | 상세 기능 |
|----------|----------|
| **회원 관리** | 소셜 로그인(네이버/카카오/구글), 프로필 관리, 애견 등록 여부에 따른 애견인/비애견인 전환 |
| **반려견 관리** | 반려견 등록(최대 10마리), 메인 반려견 설정, 공공데이터 인증 |
| **산책 매칭** | 스레드 생성/수정/삭제, 참가 조건 필터, 지도 기반 탐색 |
| **채팅** | 개별/그룹 채팅방, 실시간 메시지, 자동 아카이브 |
| **실종 찾기** | 실종 등록, 제보 등록, AI 유사도 검색, 견주-제보자 연결 |
| **커뮤니티** | 일반 피드, 댓글, 좋아요 |
| **안전 시스템** | 차단, 매너 온도, 알림 관리 |

### 사용자 유형

| 유형 | 설명 | 권한 |
|------|------|------|
| **애견인** | 반려견을 1마리 이상 등록한 사용자 | 스레드 작성, 모든 기능 이용 |
| **비애견인** | 기본 가입 상태(반려견 미등록) | 스레드 작성 불가, 허용된 스레드에만 참여 |
| **견주(Owner)** | 실종 반려견을 등록한 사용자 | 실종 등록, 유사 제보 탐색 |
| **제보자(Finder)** | 발견한 강아지를 제보한 사용자 | 제보 등록 |

## 1.2 유비쿼터스 언어 (Ubiquitous Language)

| 용어 | 정의 | 영문 |
|------|------|------|
| 스레드 | 산책 모집 게시물 | Thread |
| 산책 모집 | 스레드를 작성하여 함께 산책할 사람을 찾는 행위 | Walk Recruitment |
| 산책 신청 | 다른 사용자의 스레드에 참여 의사 표시 (즉시 채팅방 입장) | Walk Application |
| 애견인 | 반려견을 등록한 사용자 | Pet Owner |
| 비애견인 | 반려견 없이 가입한 사용자 | Non-Pet Owner |
| 매너 온도 | 사용자 신뢰도 점수 (1~10점) | Manner Temperature |
| 아카이브 | 종료된 채팅방을 읽기 전용으로 보관 | Archive |
| 개별 대화 방식 | 작성자와 신청자가 독립적인 1:1 채팅 | Individual Chat Mode |
| 그룹 대화 방식 | 모든 참여자가 단체 채팅방에서 대화 | Group Chat Mode |
| 견주(Owner) | 실종된 반려견의 정보를 등록한 사용자 | Owner |
| 제보자(Finder) | 발견한 강아지 정보를 업로드한 사용자 | Finder |

## 1.3 핵심 엔티티 식별

```
┌─────────────────────────────────────────────────────────────────┐
│                         핵심 엔티티                              │
├─────────────────────────────────────────────────────────────────┤
│ Member          - 회원 (예약어 회피: user → member)              │
│ RefreshToken    - 리프레시 토큰                                  │
│ MemberPersonalityType - 견주 성향 카테고리 (마스터)              │
│ MemberPersonality - 회원-견주 성향 연결                          │
│ Pet             - 반려견                                        │
│ PetPersonality  - 반려견 성향 (다대다 연결)                      │
│ Thread          - 산책 모집 스레드                               │
│ ThreadPet       - 스레드에 참여하는 반려견 (다대다)              │
│ ThreadFilter    - 스레드 참가 조건 필터                          │
│ ChatRoom        - 채팅방                                        │
│ ChatParticipant - 채팅방 참여자                                  │
│ Message         - 채팅 메시지                                    │
│ LostPetReport   - 실종 반려견 신고                               │
│ Sighting        - 발견 제보                                      │
│ LostPetMatch    - 실종-제보 매칭 기록                            │
│ Post            - 커뮤니티 게시물                                │
│ Comment         - 댓글                                          │
│ PostLike        - 좋아요                                        │
│ Block           - 차단                                          │
│ MannerScore     - 산책 후기 점수(매너 평가)                      │
│ Notification    - 알림                                          │
│ NotificationSetting - 알림 설정                                 │
└─────────────────────────────────────────────────────────────────┘
```

## 1.4 비즈니스 규칙 요약

### 회원 관련
- 신규 회원 매너 온도: 5.0점 (범위: 1.0 ~ 10.0)
- 닉네임 최대 10자, 특수문자 허용, 중복 불가
- 사람 프로필: 나이/성별/MBTI/성격/자기소개(선택)
- 가입 완료 시 기본 memberType=NON_PET_OWNER, 반려견 등록 시 memberType=PET_OWNER로 자동 전환
- 반려견 최대 10마리 등록 가능

### 스레드 관련
- 사용자당 동시 작성 가능 스레드: **1개**
- 예약 가능 기간: 현재 ~ 최대 1주일 후
- 필수 조건(Hard Filter) 최대 **3개**
- 필수 조건 미충족 회원에게 스레드 **미노출** (다견 가구는 메인 반려견 기준)
- 그룹 대화 정원: 3~10명

### 채팅 관련
- 메시지 최대 길이: 500자
- 텍스트 메시지만 가능
- 자동 종료: 산책 종료 시간 + 2시간
- 메시지 삭제 불가, 읽음 표시 없음
- 1:1 채팅: 산책 참가 확정 기능 제공 (상대 확정 전까지만 취소 가능, 작성자는 스레드당 1명만 확정)

### 매너 온도 관련
- 산책 종료 후 받은 후기 점수(1~10점)의 **평균값**으로 매너 온도를 계산
- 산책 후기 작성 규칙:
  - 그룹 채팅: 같은 채팅방 참가자 서로 모두 평가 가능
  - 1:1 채팅: 양쪽 산책 참가 확정 완료 시에만 서로 평가 가능
- 받은 평가가 없으면 5.0점으로 표시
- 노쇼/취소 페널티 등 추가 정책은 MVP에서 보류

---
