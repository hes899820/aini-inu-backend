# 📝 프로젝트 기획안 v4.2: 반려견 산책 소셜 매칭 플랫폼 (웹버전)

**(가제: 아이니이누 - Aini inu)**

---

## 0. 용어 정의

| 용어 | 정의 |
| --- | --- |
| 스레드 | 산책 모집 게시물 |
| 산책 모집 | 스레드를 작성하여 함께 산책할 사람을 찾는 행위 |
| 산책 신청 | 다른 사용자의 스레드에 참여 의사를 표시하는 행위 (즉시 채팅방 입장) |
| 애견인 | 반려견을 등록한 사용자 |
| 비애견인 | 반려견 없이 가입한 사용자 |
| 매너 온도 | 산책 후기 점수(1~10점)의 평균으로 계산되는 신뢰 지수 |
| 아카이브 | 종료된 채팅방을 읽기 전용으로 보관하는 것 |
| 견주(Owner) | 실종된 반려견의 정보를 등록한 사용자 |
| 제보자(Finder) | 발견한 강아지 정보를 업로드한 사용자 |
| 개별 대화 방식 | 작성자와 신청자가 각각 독립적인 1:1 채팅방에서 대화하는 방식 |
| 그룹 대화 방식 | 모든 참여자가 하나의 단체 채팅방에서 대화하는 방식 |

---

## 1. 기술 스택

### 공통
- **백엔드**: Java 21+, Spring Boot 3.x, JPA
- **프론트엔드**: Next.js, TypeScript
- **데이터베이스**: MySQL 9+ (벡터 검색 포함)
- **지도 서비스**: 네이버 지도 API
- **알림창**: 채팅 메시지 등 알림 필수
- **이미지 최적화**: 반려견 사진 업로드 및 표시 최적화
- **채팅 시스템**: 실시간 채팅 구현 (WebSocket 등)
- **스토리지**: AWS S3 (이미지 원본 및 크롭 이미지 저장)
- **시간 기준**: 모든 시간은 KST(한국 표준시) 기준

### 실종 반려견 찾기 (AI 관련)
- **멀티모달 임베딩**: CLIP 계열 모델 (OpenAI CLIP 또는 OpenCLIP)
  - 이미지와 텍스트를 동일한 벡터 공간에 임베딩
  - 텍스트 특징 설명으로 이미지 검색 가능 (Cross-modal 검색)
- **Object Detection**: YOLOv8 — Python FastAPI 마이크로서비스로 분리
- **벡터 저장**: MySQL 9+ 벡터 기능 활용

---

## 2. 서비스 핵심 컨셉 (Core Value)

- **Slogan**: "산책할까요? 우리 강아지가 그쪽 강아지를 마음에 들어 하네요"
- **Mission**: 반려견의 사회화와 주인의 소셜 라이프(친구)를 동시에 해결한다.
- **Tone & Manner**: 따뜻함, 신뢰, 활기찬, 강아지 중심

---

## 3. 입력값 제한 및 규격

### 사용자 정보

| 항목 | 규격 |
| --- | --- |
| 닉네임 | 최대 10자, 특수문자 허용, **중복 불가**, 금칙어 제한 없음 |
| 프로필 사진 | 파일 형식/용량/해상도 제한 없음 |

### 반려견 정보

| 항목 | 규격 |
| --- | --- |
| 반려견 사진 | 파일 형식/용량/해상도 제한 없음 |
| 반려견 이름 | 최대 10자 |
| 나이 | 직접 입력 (숫자) |
| 견종 | 목록에서 선택 |
| 등록 가능 마릿수 | 최대 10마리 |
| 메인 반려견 | 언제든 변경 가능 |

### 스레드

| 항목 | 규격 |
| --- | --- |
| 제목 | 최대 30자 |
| 소개글 | 최대 500자 |
| 예약 가능 기간 | 현재 시점 ~ 최대 1주일 후 (KST 기준) |
| 과거 시간 선택 | 불가 |
| 동시 작성 가능 개수 | 1개 (사용자당) |
| 수정 | 모든 항목 수정 가능 |
| 비애견인 참여 허용 | 필수 선택 (허용/불허) |

### 채팅

| 항목 | 규격 |
| --- | --- |
| 메시지 타입 | 텍스트만 가능 |
| 메시지 최대 길이 | 500자 |
| 메시지 삭제 | 불가 |
| 읽음 표시 | 제공 안 함 |
| 1:1 동시 활성 채팅방 | 제한 없음 |

### 알림

| 항목 | 규격 |
| --- | --- |
| 알림 종류 | 채팅 메시지, 산책 신청, 실종 반려견 유사 제보 |
| 알림 설정 | 종류별 ON/OFF 가능 |

---

## 4. 회원가입 및 프로필 시스템

### A. 회원가입 프로세스

1. **소셜 로그인**: 네이버, 카카오, 구글 계정으로 가입
2. **기본 닉네임 설정**: 최대 10자, 특수문자 허용, 중복 불가
3. **기본 프로필 설정 (선택)**:
    - 프로필 사진, 나이, 성별, MBTI, 성격, 자기소개
4. **초기 가입 상태**:
    - 가입 완료 시 기본 상태는 **비애견인(반려견 미등록)** 으로 저장
    - 이후 반려견을 등록하면 자동으로 애견인으로 전환됨
5. **반려견 등록** (선택, 가입 후 언제든 가능):
    - 반려동물등록 공공 데이터로 신뢰 인증 (인증마크 부여: 선택사항)
    - 사진(필수), 이름, 견종(목록 선택), 나이(직접 입력), 성별, MBTI, 중성화 여부
    - **성향 카테고리**: 소심해요, 에너지넘침, 간식좋아함, 사람좋아함, 친구구함, 주인바라기, 까칠해요
    - **산책 스타일**: 전력질주, 냄새맡기집중, 공원벤치휴식형, 느긋함, 냄새탐정, 무한동력, 저질체력
6. **애견 연계 닉네임 설정 (선택)**:
    - `[애견이름] + [아빠/엄마/형/누나/오빠/언니]` 형식
    - 예: "몽이아빠"
    - 하단에 작은 회색 글씨로 실제 닉네임 표시: `@건홍123`

### B. 프로필 구조

### 반려견 프로필 (주인공)

- 사진(필수), 견종, 나이, 성별, MBTI, 중성화 여부
- 성향 카테고리, 산책 스타일
- **다견 가구 지원**:
    - 메인 반려견 1마리 선택 (변경 가능)
    - 추가 반려견은 프로필에 함께 표시 (최대 10마리)

### 견주 프로필 (매니저)

- 본인 사진, 나이, 성별, MBTI, 성격
- **성향 카테고리**: 동네친구, 반려견정보공유, 랜선집사, 강아지만좋아함
- **매너 온도**: 산책 후기 점수(1~10점) **평균값** (신규 유저는 5점으로 표시)
    - 산책 종료 후 상대에게 후기(점수)를 남길 수 있음
    - 내 매너 온도는 **내가 받은 점수 평균**으로 갱신
    - 개밥그릇 아이콘으로 신뢰 지수 시각화

### 비애견인 프로필

- 강아지는 없지만 강아지를 좋아하는 사용자
- 본인 사진, 자기소개(선택)
- 매너 온도는 동일하게 적용
- 비애견인도 산책 참여 가능 (스레드 작성자가 허용한 경우)

---

## 5. 주요 기능 상세

### A. 산책 모집 스레드 생성

### 기본 정보

- **필수 입력**: 제목, 산책 날짜, 장소(출발지/경유지), 시작 시간, 종료 시간
- **예약 가능 기간**: 현재 시점부터 최대 1주일 후까지 (KST 기준)
- **과거 시간**: 선택 불가
- 사용자 브라우저 접속 위치 기반 근처 공원 정보 제공 (네이버 지도 API)
- **모집 방식 선택**:
    - **개별 대화 방식**: 작성자와 개별 1:1 대화 (작성자 선택형)
    - **그룹 대화 방식 (3~10명)**: 단체 채팅방 (선착순)
- **사진/설명**: 반려견 사진, 간단한 소개글 (최대 500자)
- **비애견인 참여 허용**: 필수 선택 (허용/불허)

### 다견 가구 반려견 선택

- 다견 가구 사용자가 스레드 작성 시, **참여할 반려견 선택** 단계 필수
- 1마리 또는 여러 마리 선택 가능
- 선택한 반려견 정보가 스레드에 표시됨

### 스레드 작성 제한

- **동시 작성 가능 개수**: 사용자당 1개
- **비애견인**: 스레드 작성 불가
- 기존 스레드가 종료(아카이브)되어야 새 스레드 작성 가능

### 스레드 수정

- 작성 후 모든 항목 수정 가능
- 수정 시 기존 채팅방 참여자에게 시스템 메시지: "스레드 정보가 수정되었습니다"

### 참가 조건 필터 설정

스레드 작성 시 참가자 조건을 설정할 수 있으며, **필수 조건**과 **선호 조건** 두 가지 유형으로 구분된다.

**필터 가능 항목 (애견인 대상)**:

- 사이즈 (소형/중형/대형)
- 중성화 여부
- 성별 (애견)
- 견종
- MBTI
- 성향 카테고리
- 산책 스타일

**비애견인 참여 설정**:

- **필수 선택 항목**: 비애견인 참여 허용 여부 (허용/불허)
- "비애견인 불허" 설정 시 비애견인에게 해당 스레드 미노출

**필수 조건 (Hard Filter)**:

- 작성자가 각 필터 항목에 대해 "필수"로 지정할 수 있음
- **최대 3개까지만** 필수 조건으로 설정 가능
- 필수 조건을 충족하지 않는 회원에게는 해당 스레드가 **노출되지 않음**
- 다견 가구 애견인의 필터 충족 판정은 **메인 반려견 기준**으로 수행
- 3개 초과 선택 시 추가 선택 불가 (UI에서 차단)
- **비애견인**: 비애견인 참여가 허용된 스레드라도, 반려견 관련 필수 조건이 하나라도 있으면 비애견인에게는 노출되지 않음

**선호 조건 (Soft Filter)**:

- 필수로 지정하지 않은 나머지 조건은 자동으로 선호 조건이 됨
- 선호 조건을 충족하지 않아도 스레드는 **정상 노출**됨
- 스레드 상세 화면에서 작성자의 선호 조건 안내 문구 표시
- 선호 조건 미충족 시 산책 신청 전 안내 팝업 표시:
    - "작성자가 선호하는 조건: [에너지 넘치는 성향]"
    - [그래도 신청하기] / [돌아가기] 버튼

**기본값**:

- 모든 필터의 기본값은 "상관없음"
- 비애견인 참여는 기본값 없음 (필수 선택)
- 기본 상태에서는 모든 회원에게 스레드 노출

### 지도 표시 옵션 (작성자 선택)

```
[ ] 산책 종료 전까지 항상 지도에 표시
[ ] 산책 시간대만 지도에 표시 (예: 14:00~16:00)
```

- **항상 표시**: 스레드 작성 후 산책 종료 시간까지 지도에 계속 노출
- **시간대만 표시**: 다른 회원이 시간대로 필터링했을 때 해당 시간대가 겹치거나 포함되면 지도에 표시

### B. 지도 기반 탐색

### 위치 표시

- 본인의 위치는 **사용자 브라우저 접속 위치** 기반으로 표시
- 위치 권한 허용 필요 (거부 시 수동 검색 가능)

### 시간대 필터링

- 회원들은 지도에서 원하는 시간대를 설정
- 해당 시간대에 포함되어 있는 스레드만 지도에 표시
- 예: "오늘 10:00~16:00" 필터 → 그 시간대에 포함된 스레드만 보임

### 스레드 목록 정렬

스레드 목록은 다음 3가지 기준으로 정렬 가능:

| 정렬 기준 | 설명 |
|----------|------|
| 시간순 | 산책 예정 시간이 가까운 순서 |
| 거리순 | 현재 위치에서 가까운 순서 |
| 인기순 | 참여자 수 또는 조회수 기준 |

### 장소 기반 스레드 생성

1. **장소 선택**: 특정 공원/장소를 선택하여 스레드 생성
2. **중복 방지 로직**:
    - 같은 장소 + 같은 날짜 + **시작 시간 기준 ±2시간** 이내 기존 스레드가 있으면
    - 기존 스레드 목록을 먼저 보여줌 (날짜/시간별 정렬)
    - 원하는 시간대가 없으면 새 스레드 생성 가능

### C. 스레드 삭제

- 작성자는 언제든 본인이 작성한 스레드를 삭제할 수 있음
- **스레드 삭제 시 연결된 모든 채팅방도 함께 종료됨**
- 채팅방 참여자에게 시스템 메시지 표시: "작성자가 산책 모집을 취소했습니다"
- 종료된 채팅방은 아카이브 처리 (읽기 전용)

---

## 6. 매칭 및 채팅 시스템

### A. 산책 신청 프로세스

### 1단계: 탐색

- 홈 피드, 지도에서 산책 모집 스레드 확인
- 차단한 유저의 스레드는 노출되지 않음
- 나를 차단한 유저의 스레드에는 신청 불가

### 2단계: 반려견 선택 (다견 가구)

- 비애견인은 반려견 선택 단계 없음
- 다견 가구 사용자가 신청 시, **참여할 반려견 선택** 단계 필수
- 1마리 또는 여러 마리 선택 가능
- 선택한 반려견 정보가 채팅방에서 표시됨

### 3단계: 산책 신청 = 채팅방 입장

- **[산책 신청]** 버튼 클릭 → 즉시 채팅방 입장

**개별 대화 방식**:

```
작성자 A가 스레드 작성 (개별 대화 방식 선택)
→ B, C, D가 "산책 신청" 클릭
→ A-B, A-C, A-D 각각 독립적인 1:1 채팅방 생성
→ B, C, D는 서로의 존재를 모름
→ 정원 제한 없음 (A는 여러 명과 동시 대화 가능)
→ A가 마음에 드는 사람과 실제 산책 진행
```

**그룹 대화 방식 (3~10명)**:

```
작성자 A가 "5명 모집" 스레드 작성 (그룹 대화 방식 선택)
→ B, C, D, E가 "산책 신청" 클릭
→ 하나의 단체 채팅방에 A, B, C, D, E 모두 입장
→ 서로 누가 참여했는지 보임
→ 5명 정원 차면 더 이상 신청 불가 (선착순)
→ 참여자 모두 함께 산책 진행
```

### 4단계: 산책 참가 확정 (개별 대화 방식 전용)

- 개별 대화 방식에서는 **산책 신청=대화 시작**이며, 실제 산책 참가 확정은 별도로 진행
- 해당 **1:1 채팅방 내부에서** 양쪽이 각각 "산책 확정"을 누르면 확정됨 (당사자만 확인)
- 작성자는 **한 스레드에서 1명(1개 채팅방)만** 산책 참가 확정 가능
- 확정 취소는 **상대가 아직 확정하지 않은 경우에만** 가능 (상대 확정 후에는 취소 불가)
- 확정 정보는 **스레드/지도/프로필 등 공개 영역에 표시하지 않음**
- 확정 후에도 스레드는 자동 마감되지 않으며, 작성자는 다른 신청자와도 계속 대화 가능 (단, 산책 확정은 1명만 가능)
- 산책 종료 후 후기는 **확정된 1:1 채팅방에서만** 서로 작성 가능

### 프로필 표시 방식

- **애견인**: 애견 사진(선택한 반려견) + 오른쪽 하단에 견주 프로필 사진 겹쳐서 표시
- **비애견인**: 본인 프로필 사진 1개만 표시
- 프로필 사진 클릭 시 확대 및 상세 정보 표시

### B. 채팅방 운영

### 메시지 규격

- **메시지 타입**: 텍스트만 가능
- **최대 길이**: 500자
- **메시지 삭제**: 불가
- **읽음 표시**: 제공 안 함

### 채팅 가능 시간

```
산책 예정 시간: 14:00~16:00 (KST)

채팅 가능 기간:
- 스레드 작성 시점 ~ 18:00 (산책 종료 +2시간)
- 18:00 도달 시 자동으로 채팅방 종료 및 아카이브
```

### 채팅방 종료 및 보관

- **자동 종료**: 산책 종료 시간 +2시간 후 자동 종료 (KST 기준)
- 작성자가 수동으로 "종료" 버튼을 누를 필요 없음
- 종료 후 채팅방은 **아카이브** (읽기 전용)
- **"지난 산책"** 탭에서 조회 가능
- 새 메시지 작성 불가

### 시스템 메시지

다음 상황에서 시스템 메시지가 자동 발송됨:

| 상황 | 메시지 내용 |
| --- | --- |
| 참여자 입장 (그룹) | "OO님이 참여했습니다" |
| 참여자 퇴장 | "OO님이 나가셨습니다" |
| 스레드 수정 | "스레드 정보가 수정되었습니다" |
| 스레드 삭제 | "작성자가 산책 모집을 취소했습니다" |
| 채팅방 자동 종료 | "채팅방이 종료되었습니다" |

### C. 참가 취소

- **언제든 취소 가능** (시간 제한 없음)
- **개별 대화 방식**: 해당 채팅방만 나가기 (다른 채팅방에는 영향 없음)
- **그룹 대화 방식**: 단체방에 "OO님이 나가셨습니다" 시스템 메시지
- **그룹 채팅에서 참가자 퇴장 시**: 정원 미달이 되면 다시 신청 가능 상태로 전환
- **재입장**: 퇴장 후 재입장에 제한 없음 (정원 여유 시 다시 신청 가능)
- 취소 남용 방지(취소 횟수 지표/패널티)는 MVP에서 보류

---

## 7. 안전 및 신뢰 시스템

### A. 차단

- **사용자 차단**: 특정 회원 차단 가능
    - 차단된 사용자의 게시물 및 스레드 미노출
    - 차단한 사용자는 내 스레드에 신청 불가
- **차단 관리**: 차단 목록 조회 가능, 차단 해제 가능

### B. 산책 후기 (1~10점)

- **작성 시점**: 산책 종료 후
- **작성 내용**: 1~10점 점수 + 한줄 후기(선택)
- **작성 대상**:
    - 그룹 채팅: 같은 채팅방 참가자 서로 모두 평가 가능
    - 1:1 채팅: 해당 채팅방에서 서로 산책 참가 확정된 경우에만 평가 가능
- **작성 제한**: 같은 산책(채팅방)에서 같은 대상에게 1회만 작성 가능

### C. 매너 온도 계산

- **신규 유저**: 받은 평가가 없으면 5.0점으로 표시
- **계산 방식**: 내가 받은 점수의 평균값 (소수점 1자리 반올림)
- 노쇼/취소 등 페널티 정책은 MVP에서 보류

---

## 8. 커뮤니티 기능

### A. 일반 피드 (SNS)

- 자유롭게 반려견 관련 게시물 작성
- 강아지 동반 가능한 카페/맛집 공유 가능
- 댓글, 좋아요 기능
- "산책" 중심이 아닌 일상 공유 공간

---

## 9. 알림 시스템

### 알림 종류

| 알림 유형 | 발송 조건 |
| --- | --- |
| 채팅 메시지 | 새 메시지 수신 시 |
| 산책 신청 | 내 스레드에 새 참여자 입장 시 |
| 실종 반려견 유사 제보 | 내 실종 등록 건에 유사한 제보 등록 시 (다이제스트) |

### 알림 설정

- 사용자가 각 알림 유형별로 ON/OFF 설정 가능
- 기본값: 모든 알림 ON

---

## 10. 실종 반려견 찾기 (부가 기능)

### A. 서비스 개요

사용자가 잃어버린 반려견 정보를 등록하면, AI가 **유사도 순으로 정렬된 후보 리스트**를 제공하여 견주가 직접 빠르게 훑어볼 수 있게 돕는 서비스.

### B. 핵심 기능

1. **견주(Owner)**: 실종된 반려견의 사진 및 특징(견종, 나이, 실종 장소, 외형 특징 등) 등록
2. **제보자(Finder)**: 길거리에서 발견한 강아지 사진 업로드 (텍스트 설명은 선택)
3. **시스템(System)**:
   - 멀티모달 임베딩을 통해 이미지와 텍스트를 동일한 벡터 공간에서 검색
   - 유사도 + 지역 + 시간을 종합한 점수로 정렬된 후보 리스트 제공
   - 견주가 직접 리스트를 탐색하며 확인

### C. 멀티모달 임베딩 방식

#### 개념

CLIP 계열 모델을 사용하여 **이미지와 텍스트를 동일한 벡터 공간**에 임베딩한다. 이를 통해 견주가 입력한 텍스트 특징 설명으로 제보자의 이미지를 검색할 수 있다 (Cross-modal 검색).

#### 임베딩 흐름

```
[견주 - 실종 등록]
이미지: 강아지 사진 ──────────────────┐
                                      ├──▶ 동일 벡터 공간 ──▶ MySQL 벡터 저장
텍스트: "갈색 포메라니안, 엉덩이에    │
        검은 점, 빨간 목줄 착용" ─────┘

[제보자 - 발견 등록]
이미지: 발견한 강아지 사진 ──▶ 동일 벡터 공간 ──▶ MySQL 벡터 저장
(텍스트 설명은 선택 사항)
```

#### Cross-modal 검색 예시

```
견주의 텍스트 특징: "엉덩이에 점이 있는 갈색 포메라니안"
          ↓ CLIP 임베딩 (텍스트 → 벡터)
          ↓
제보 DB의 이미지 벡터들과 유사도 비교
          ↓
실제로 엉덩이에 점이 있는 갈색 포메라니안 이미지가 상위 랭크
```

#### 장점

- **제보자 입력 부담 최소화**: 사진만 올려도 검색 가능
- **비대칭 입력 대응**: 견주는 상세 설명, 제보자는 사진만 올려도 매칭
- **텍스트 특징 활용**: "빨간 목줄", "엉덩이 점" 등 세부 특징으로 검색 가능

#### 한계 및 보완

- CLIP은 세부 특징(점 위치 등) 인식에 한계가 있을 수 있음
- 향후 고도화 시 LLM 자동 특징 추출 또는 LLM 2차 판단 추가 고려

### D. 유사도 점수 계산 및 정렬 로직

#### 종합 점수 공식

```
최종 점수 = (멀티모달 유사도 × W1) + (지역 근접도 × W2) + (시간 근접도 × W3)
```

#### 가중치 초기값 (튜닝 대상)

| 요소 | 가중치 | 설명 |
|------|--------|------|
| 멀티모달 유사도 | **0.5** | 이미지-이미지, 텍스트-이미지 간 코사인 유사도 (0~1) |
| 지역 근접도 | **0.3** | 실종/발견 장소 간 거리 기반 (거리 역수 정규화) |
| 시간 근접도 | **0.2** | 실종/발견 시간 간격 기반 (시간차 역수 정규화) |

#### 멀티모달 유사도 계산

견주가 이미지와 텍스트를 모두 등록한 경우, 두 벡터를 활용하여 유사도를 계산한다.

```
멀티모달 유사도 = max(이미지-이미지 유사도, 텍스트-이미지 유사도)
```

또는 가중 평균 방식:

```
멀티모달 유사도 = (이미지-이미지 유사도 × 0.6) + (텍스트-이미지 유사도 × 0.4)
```

→ 어떤 방식이 더 효과적인지는 테스트를 통해 튜닝

#### 지역 근접도 (Location Proximity)

```
지역 점수 = 1 / (1 + 거리(km))

예시:
- 같은 동네 (1km 이내): 1 / (1 + 1) = 0.5 → 정규화 후 ~1.0
- 같은 구 (5km): 1 / (1 + 5) = 0.17 → 정규화 후 ~0.6
- 다른 도시 (50km): 1 / (1 + 50) = 0.02 → 정규화 후 ~0.1
```

#### 시간 근접도 (Time Proximity)

```
시간 점수 = 1 / (1 + 경과일수)

예시:
- 당일: 1 / (1 + 0) = 1.0
- 3일 전: 1 / (1 + 3) = 0.25
- 7일 전: 1 / (1 + 7) = 0.125
- 30일 전: 1 / (1 + 30) = 0.03
```

#### 정렬 결과 예시

| 순위 | 멀티모달 유사도 | 거리 | 경과일 | 종합 점수 |
|------|----------------|------|--------|-----------|
| 1 | 0.85 | 2km | 1일 | 0.78 |
| 2 | 0.92 | 15km | 0일 | 0.71 |
| 3 | 0.88 | 3km | 5일 | 0.65 |
| 4 | 0.70 | 1km | 0일 | 0.62 |

### E. 상세 프로세스 흐름

#### Scenario A: 견주가 "실종 강아지"를 등록할 때

1. **이미지 및 텍스트 업로드**: 
   - 사진 (필수)
   - 텍스트 특징 설명 (선택): "갈색 포메라니안, 엉덩이에 검은 점, 빨간 목줄"
   - 메타 정보: 견종, 색상, 크기, 실종 장소/시간, 특이사항
2. **전처리 (YOLO Crop)**:
   - 서버에서 이미지를 받아 YOLO 모델에 입력
   - '개'에 해당하는 바운딩 박스 좌표 추출 후 이미지 크롭
   - 개가 탐지되지 않으면 "강아지가 잘 보이는 사진을 올려주세요" 반려 처리
3. **멀티모달 임베딩**:
   - 크롭된 이미지 → CLIP 이미지 인코더 → 벡터
   - 텍스트 특징 설명 → CLIP 텍스트 인코더 → 벡터 (입력한 경우)
4. **저장**: DB에 메타 정보와 벡터들 저장 (MySQL 벡터), S3에 원본 및 크롭 이미지 저장
5. **즉시 검색 결과 제공**: 기존 제보 DB에서 멀티모달 유사도 기반 정렬된 리스트 반환
6. **알림 설정**: 새 제보 등록 시 다이제스트 알림 수신 여부 선택

#### Scenario B: 제보자가 "발견한 강아지"를 올릴 때

1. **이미지 접수 및 전처리**: 제보 사진에 대해서도 동일하게 YOLO 기반 객체 탐지 및 크롭 수행
2. **멀티모달 임베딩**: 크롭된 이미지 → CLIP 이미지 인코더 → 벡터
3. **저장**: 임베딩 후 제보 DB에 저장 (MySQL 벡터)
4. **역방향 매칭**: 
   - 기존 실종 DB의 이미지 벡터 및 텍스트 벡터와 유사도 검색
   - 유사한 건의 견주들에게 다이제스트 알림 대상으로 추가

**제보 관리 (제보자)**:
- 제보자는 본인이 등록한 제보 목록/상세를 조회할 수 있음
- 제보자는 본인 제보를 삭제할 수 있으며, 삭제된 제보는 유사도 검색 대상에서 제외

#### Scenario C: 견주가 "유사 후보 리스트"를 확인할 때

1. **리스트 요청**: 견주가 앱에서 "유사한 제보 보기" 탭 진입
2. **필터링**: 지역 범위(예: 반경 10km), 기간(예: 최근 30일) 설정
3. **검색 및 정렬**: 
   - 견주의 이미지 벡터 + 텍스트 벡터로 제보 DB 검색
   - 필터 조건 내에서 종합 점수 계산 후 정렬
4. **리스트 반환**: 상위 N건(예: 50건) 카드 형태로 반환
5. **상세 확인**: 카드 탭 시 제보 상세 정보(사진, 발견 장소) 노출
6. **액션**: "이 아이예요!" 버튼 → 제보자와 1:1 채팅방 생성

### F. 실종-제보 연결 프로세스

1. **견주가 "이 아이예요!" 버튼 클릭**
2. **시스템이 견주-제보자 간 1:1 채팅방 자동 생성**
3. **채팅방 내 시스템 메시지**: "실종 반려견 [이름] 관련 문의입니다"
4. **대화를 통해 직접 연락처 교환 및 만남 약속**
5. **견주가 반려견을 찾으면 "실종 등록 종료" 버튼으로 직접 종료**

### G. 실종 등록 관리

- **등록 종료**: 견주가 직접 "실종 등록 종료" 버튼으로 종료/해제
- **종료 시**: 해당 실종 건에 대한 알림 발송 중단, 검색 결과에서 제외
- **데이터 보관**: 종료된 실종 건은 아카이브 처리 (통계 목적)

### H. 양방향 흐름 요약

```
[실종 등록] ──────┬──────▶ 이미지/텍스트 멀티모달 임베딩 ──▶ 실종 DB 저장 (MySQL 벡터)
                  │
                  └──────▶ 기존 제보 DB 검색 (Cross-modal) ──▶ 즉시 유사 리스트 제공

[제보 등록] ──────┬──────▶ 이미지 멀티모달 임베딩 ──▶ 제보 DB 저장 (MySQL 벡터)
                  │
                  └──────▶ 기존 실종 DB 검색 (이미지↔이미지, 이미지↔텍스트) 
                           ──▶ 해당 견주 다이제스트 대상 추가

[견주 탐색] ──────▶ 필터 설정 ──▶ 멀티모달 유사도 + 지역 + 시간 종합 정렬 
                   ──▶ 리스트 반환 ──▶ 상세 확인 ──▶ "이 아이예요!" 
                   ──▶ 1:1 채팅방 생성 ──▶ 연락

[실종 종료] ──────▶ 견주가 직접 "실종 등록 종료" ──▶ 알림 중단 ──▶ 아카이브
```

---

## 11. 차별화 포인트

### 1. 비애견인 환영

- 강아지가 없어도 가입 가능
- "랜선 집사" 유저 공략
- 스레드 작성 시 **비애견인 참여 허용 여부 필수 선택**

### 2. 반려견이 주인공

- UI에서 반려견 프로필이 항상 앞에 표시
- 견주는 "매니저" 역할

### 3. 자유 채팅 방식

- 승인/거절 절차 없음
- 산책 신청 = 즉시 채팅방 입장
- 개별 대화 방식에서는 작성자가 여러 명과 동시 대화 가능
- 자연스럽고 부담 없는 소통

### 4. 장소 기반 + 시간대 필터

- 특정 위치 중심으로 산책 모집
- 지도에서 시간대 필터링으로 원하는 시간대만 검색
- 시간순/거리순/인기순 정렬 지원

### 5. 유연한 필터 시스템

- 작성자가 필수 조건을 직접 선택 (최대 3개)
- 나머지는 선호 조건으로 안내만 제공
- 비애견인 참여 여부 필수 선택
- 매칭 풀 고갈 방지 + 작성자 의도 존중

### 6. 멀티모달 AI 기반 실종 반려견 탐색

- CLIP 멀티모달 임베딩으로 이미지-텍스트 Cross-modal 검색
- 견주의 텍스트 특징 설명("엉덩이 점, 빨간 목줄")으로 제보 이미지 검색 가능
- 제보자는 사진만 올려도 매칭 가능 (입력 부담 최소화)
- 유사도 + 지역 + 시간 종합 점수로 정렬
- 채팅방을 통한 견주-제보자 직접 연결

---

## 12. 데이터 관리

- 반려동물등록 공공 데이터 연동
- 채팅방 아카이브 관리
- 실종/제보 멀티모달 임베딩 벡터 데이터 관리 (MySQL 9+ 벡터)
- 모든 시간 데이터는 KST 기준 저장 및 표시

---

## 13. 보류 항목 (추후 논의 필요)

| 항목 | 상태 | 비고 |
| --- | --- | --- |
| 노쇼 처리 | 보류 | 페널티, 판단 기준 등 |
| 평가 미완료 페널티 | 보류 | MVP에서는 미평가 페널티 없음 |
| 애견 MBTI 측정 방법 | 보류 | 간단한 테스트 제공 또는 제거 고려 |
| 정기 모임 | 보류 | Post MVP 기능으로 검토 |
| 멀티모달 유사도 계산 방식 | 보류 | max vs 가중평균, 테스트 후 결정 |
| LLM 2차 판단 추가 | 보류 | 고도화 단계에서 검토 |
| 아카이브 보관 기간 | 보류 | 채팅방 아카이브 데이터 보관 정책 |

---

## 15. 앱버전 (추후 진행 예정)

### 실시간 알림

- 본인 근처 장소와 유사한 시간대에 산책 모집이 올라오면 실시간으로 알려준다.

---
